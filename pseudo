storage = []
repeat rollout_count:
	action, ... = actor(state)
	next_state, reward, terminal, _ = env_step(action)
	storage.append((action, rewards, terminals, ...))
	state = next_state

action, s_value, ... = actor(state)
storage.append((action, None, None))

advantage = 1
return = s_value
for i in (0..rollout_count).reverse():
	return = storage[i].r + discount * (1 - storage[i].terminal) * return
	if not use_gae:
		advantages = returns - storage.v[i].detach()
	else:
		td_error = storage.r[i] + config.discount * storage.m[i] * storage.v[i + 1] - storage.v[i]
		advantages = advantages * config.gae_tau * config.discount * storage.m[i] + td_error 